define(["eui/modules/uibase"],function(d){var c=d.EComponent;var b=EUI.browser;function a(e){c.call(this,e);this.groupIds=[];this.focusedElement=null;this._initEListBox(e);this.isVert=EUI.parseBool(e.isVert,false);this.setOnClick(e.onclick);this.setOnDblClick(e.ondblclick);}EUI.extendClass(a,c,"EListBox");a.DEFAULT_ID_PREFIX="ESEN$EListBox";a.DEFAULT_GROUP_ID_PREFIX="ESEN$EListBox$Group";a.prototype.getContent=function(){return this.baseDiv;};a.prototype.getBaseDom=a.prototype.getContent;a.prototype.dispose=function(){this.groupIds=null;this.baseDiv=null;this._doClick=null;this._doDblClick=null;this.focusedElement=null;c.prototype.dispose.call(this);};a.prototype._initEListBox=function(e){this.baseDiv=this.parentElement.appendChild(this.doc.createElement("div"));this.baseDiv.className="eui-listbox-container "+(e.baseCss||"");this.baseDiv.style.cssText+=";width: "+this.width+";height:"+this.height+";";this.baseDiv.id=EUI.idRandom(a.DEFAULT_ID_PREFIX);this.basedom=this.baseDiv;};a.prototype._doClickItem=function(f,e){this.setItemFocus(f,e);};a.prototype.setOnClick=function(e){this._doClick=e;};a.prototype._doDblClickItem=function(f,e){if(EUI.isFunction(this._doDblClick)){this._doDblClick(this,f,e);}};a.prototype.setOnDblClick=function(e){this._doDblClick=e;};a.prototype.getFocusItem=function(){return this.focusedElement;};a.prototype.setItemFocus=function(g,e,f){var h=g;if(h!==this.focusedElement){this.setItemUnFocus();if(h){this.focusedElement=h;h.className="eui-listbox-item-check";}}if(EUI.isFunction(this._doClick)&&f!==true){this._doClick(this,g,e);}};a.prototype.setItemUnFocus=function(){if(this.focusedElement){this.focusedElement.className="eui-listbox-item";this.focusedElement=null;}};a.prototype.addGroupElement=function(i,h){var e=this.baseDiv.appendChild(this.doc.createElement("ul"));e.className="eui-listbox-group";var f=e.id=EUI.idRandom(a.DEFAULT_GROUP_ID_PREFIX);this.groupIds.push(f);if(EUI.parseBool(i)){var g=e.appendChild(this.doc.createElement("li"));g.className="eui-listbox-caption";var j=g.appendChild(this.doc.createElement("span"));j.innerHTML=h?h:"";}return e;};a.prototype.setGroupText=function(e,g){var f=this.getCaptionItem(e);f.firstChild.innerHTML=(g||"");};a.prototype.addVertGroup=function(k,h){if(!EUI.isArray(k)||!this.isVert){return;}var g=this.doc.createElement("div");g.className="eui-col-xl-"+h;for(var j=0,f=k.length;j<f;j++){var e=k[j];g.appendChild(this.getGroupElement(e));}var l=this.getContent();EUI.addClassName(l,"eui-row eui-col-space-30");l.appendChild(g);};a.prototype.getCaptionItem=function(e){var f=this.getGroupElement(e);return !f?null:this.isCaptionItem(f.childNodes[0])?f.childNodes[0]:null;};a.prototype.isCaptionItem=function(f){var e=false;if(f&&f.className.startsWith("eui-listbox-caption")){e=true;}return e;};a.prototype.getGroupElement=function(e){e=e==-1?this.groupIds.length-1:e;if(isNaN(e)||e<0||e>this.groupIds.length-1){return null;}var g=this.groupIds[e];var f=this.doc.getElementById(g);return f;};a.prototype.getGroupsCount=function(){return this.groupIds.length;};a.prototype.addItem=function(h,e){e=isNaN(e)?this.groupIds.length-1:e;var g=this.getGroupElement(e);if(!g){g=this.addGroupElement(false);}var f=g.appendChild(this.doc.createElement("li"));f.className="eui-listbox-item";if(h){$(f).append(h);}f.onclick=this._doClickItem.bind(this,f);f.ondblclick=this._doDblClickItem.bind(this,f);return f;};a.prototype.getItem=function(g,e){e=isNaN(e)?this.groupIds.length-1:e;var f=this.getGroupElement(e);if(!f){return null;}g=this.isCaptionItem(f.childNodes[0])?g+1:g;return f.childNodes[g];};a.prototype.removeItem=function(h,e){e=isNaN(e)?this.groupIds.length-1:e;var f=this.getGroupElement(e);if(!f){return;}if(EUI.isNumber(h)){var g=Array.prototype.slice.call(f.childNodes);h=g[h];}if(this.focusedElement===h){this.focusedElement=null;}f.removeChild(h);};a.prototype.getItemIndex=function(h,e){h=h||0;var f=this.getGroupElement(h);if(!f){return -1;}var g=Array.prototype.slice.call(f.childNodes);return g.indexOf(e);};a.prototype.getItemsCountByGroup=function(e){var f=this.getGroupElement(e);return !f?0:this.isCaptionItem(f.childNodes[0])?f.childNodes.length-1:f.childNodes.length;};a.prototype.clear=function(){this.baseDiv.innerHTML="";this.groupIds=[];this.focusedElement=null;};return{EListBox:a};});